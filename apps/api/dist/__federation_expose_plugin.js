"use strict";exports.ids=["194"],exports.modules={5365(e,t,r){r.r(t),r.d(t,{CreateCheckoutInputSchema:()=>S,CreateCheckoutOutputSchema:()=>E,DeliveryEstimateSchema:()=>g,ProductSchema:()=>p,PublishInputSchema:()=>l,PublishOutputSchema:()=>d,ConnectOutputSchema:()=>s,ConnectInputSchema:()=>u,ProductCategorySchema:()=>f,OrderStatusSchema:()=>y,default:()=>et,ShippingAddressSchema:()=>m,OrderSchema:()=>v,CollectionSchema:()=>h,TrackingInfoSchema:()=>b,WebhookResponseSchema:()=>w});var n=r(8962),o=r(458),i=r(8460),a=r(9305),c=r(4457),u=i.z.object({accountId:i.z.string().min(1,"Account ID is required").describe("The account ID to ensure storage deposit for")}),s=i.z.object({accountId:i.z.string().describe("The account ID that was connected"),hasStorage:i.z.boolean().describe("Whether the account already had storage"),depositTxHash:i.z.string().optional().describe("Transaction hash if a deposit was made")}),l=i.z.object({payload:i.z.string().min(1,"Payload is required").describe("Base64 encoded signed delegate action")}),d=i.z.object({hash:i.z.string().describe("Transaction hash")}),f=i.z.enum(["Men","Women","Accessories","Exclusives"]),p=i.z.object({id:i.z.string(),name:i.z.string(),description:i.z.string().optional(),price:i.z.number(),currency:i.z.string().default("USD"),category:f,image:i.z.string(),productUid:i.z.string().optional(),fileUrl:i.z.string().optional()}),h=i.z.object({slug:i.z.string(),name:i.z.string(),description:i.z.string().optional()}),m=i.z.object({companyName:i.z.string().optional(),firstName:i.z.string().min(1),lastName:i.z.string().min(1),addressLine1:i.z.string().min(1),addressLine2:i.z.string().optional(),city:i.z.string().min(1),state:i.z.string().min(1),postCode:i.z.string().min(1),country:i.z.string().length(2),email:i.z.string().email(),phone:i.z.string().min(1).optional()}),g=i.z.object({minDeliveryDate:i.z.string(),maxDeliveryDate:i.z.string()}),y=i.z.enum(["pending","paid","processing","printing","shipped","delivered","cancelled"]),b=i.z.object({trackingCode:i.z.string(),trackingUrl:i.z.string(),shipmentMethodName:i.z.string(),shipmentMethodUid:i.z.string().optional(),fulfillmentCountry:i.z.string().optional(),fulfillmentStateProvince:i.z.string().optional(),fulfillmentFacilityId:i.z.string().optional()}),v=i.z.object({id:i.z.string(),userId:i.z.string(),productId:i.z.string(),productName:i.z.string(),quantity:i.z.number(),totalAmount:i.z.number(),currency:i.z.string(),status:y,checkoutSessionId:i.z.string().optional(),checkoutProvider:i.z.enum(["stripe","near"]).optional(),fulfillmentOrderId:i.z.string().optional(),fulfillmentReferenceId:i.z.string().optional(),shippingAddress:m.optional(),trackingInfo:i.z.array(b).optional(),deliveryEstimate:g.optional(),createdAt:i.z.string().datetime(),updatedAt:i.z.string().datetime()}),S=i.z.object({productId:i.z.string(),quantity:i.z.number().int().positive().default(1),successUrl:i.z.string().url(),cancelUrl:i.z.string().url()}),E=i.z.object({checkoutSessionId:i.z.string(),checkoutUrl:i.z.string().url(),orderId:i.z.string()}),w=i.z.object({received:i.z.boolean()}),k=c.oc.router({connect:c.oc.route({method:"POST",path:"/connect",summary:"Connect to contract",description:"Ensures the account has storage deposit on the contract. If not, makes a deposit on behalf of the user.",tags:["Relayer"]}).input(u).output(s),publish:c.oc.route({method:"POST",path:"/publish",summary:"Publish a signed delegate action",description:"Submits a signed delegate action (meta-transaction) to the network. Used for gasless social posts and profile updates.",tags:["Relayer"]}).input(l).output(d),ping:c.oc.route({method:"GET",path:"/ping",summary:"Health check",description:"Simple ping endpoint to verify the API is responding.",tags:["Health"]}).output(i.z.object({status:i.z.literal("ok"),timestamp:i.z.string().datetime()})),getProducts:c.oc.route({method:"GET",path:"/products",summary:"List all products",description:"Returns a list of all available products.",tags:["Products"]}).input(i.z.object({category:f.optional(),limit:i.z.number().int().positive().max(100).default(50),offset:i.z.number().int().min(0).default(0)})).output(i.z.object({products:i.z.array(p),total:i.z.number()})),getProduct:c.oc.route({method:"GET",path:"/products/{id}",summary:"Get product by ID",description:"Returns a single product by its ID.",tags:["Products"]}).input(i.z.object({id:i.z.string()})).output(i.z.object({product:p})),searchProducts:c.oc.route({method:"GET",path:"/products/search",summary:"Search products",description:"Search products by query string.",tags:["Products"]}).input(i.z.object({query:i.z.string(),category:f.optional(),limit:i.z.number().int().positive().max(100).default(20)})).output(i.z.object({products:i.z.array(p)})),getFeaturedProducts:c.oc.route({method:"GET",path:"/products/featured",summary:"Get featured products",description:"Returns a curated list of featured products.",tags:["Products"]}).input(i.z.object({limit:i.z.number().int().positive().max(20).default(8)})).output(i.z.object({products:i.z.array(p)})),getCollections:c.oc.route({method:"GET",path:"/collections",summary:"List all collections",description:"Returns a list of all product collections/categories.",tags:["Collections"]}).output(i.z.object({collections:i.z.array(h)})),getCollection:c.oc.route({method:"GET",path:"/collections/{slug}",summary:"Get collection by slug",description:"Returns a collection with its products.",tags:["Collections"]}).input(i.z.object({slug:i.z.string()})).output(i.z.object({collection:h,products:i.z.array(p)})),createCheckout:c.oc.route({method:"POST",path:"/checkout",summary:"Create checkout session",description:"Creates a new checkout session for purchasing a product.",tags:["Checkout"]}).input(S).output(E),getOrders:c.oc.route({method:"GET",path:"/orders",summary:"List user orders",description:"Returns a list of orders for the authenticated user.",tags:["Orders"]}).input(i.z.object({limit:i.z.number().int().positive().max(100).default(10),offset:i.z.number().int().min(0).default(0)})).output(i.z.object({orders:i.z.array(v),total:i.z.number()})),getOrder:c.oc.route({method:"GET",path:"/orders/{id}",summary:"Get order by ID",description:"Returns a single order by its ID.",tags:["Orders"]}).input(i.z.object({id:i.z.string()})).output(i.z.object({order:v})),stripeWebhook:c.oc.route({method:"POST",path:"/webhooks/stripe",summary:"Stripe webhook",description:"Handles Stripe webhook events for payment processing.",tags:["Webhooks"]}).input(i.z.object({body:i.z.string(),signature:i.z.string()})).output(w),fulfillmentWebhook:c.oc.route({method:"POST",path:"/webhooks/fulfillment",summary:"Fulfillment webhook",description:"Handles fulfillment provider webhook events (Gelato).",tags:["Webhooks"]}).input(i.z.object({body:i.z.string(),signature:i.z.string()})).output(w)}),I=r(1964);function O(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){r(e);return}c.done?t(u):Promise.resolve(u).then(n,o)}function z(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){O(i,n,o,a,c,"next",e)}function c(e){O(i,n,o,a,c,"throw",e)}a(void 0)})}}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var C=function(){var e;function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"social.near";if(!(this instanceof t))throw TypeError("Cannot call a class as a function");P(this,"near",void 0),P(this,"graph",void 0),P(this,"relayerAccountId",void 0),P(this,"contractId",void 0),this.near=e,this.relayerAccountId=r,this.contractId=n,this.graph=new I.TS({near:e,contractId:n})}return e=[{key:"ensureStorageDeposit",value:function(e){return z(function(){var t;return A(this,function(r){switch(r.label){case 0:return[4,this.graph.storageBalanceOf(e)];case 1:if(null!==(t=r.sent())&&BigInt(t.total)>0n)return[2,{accountId:e,hasStorage:!0}];return[4,this.near.transaction(this.relayerAccountId).functionCall(this.contractId,"storage_deposit",{account_id:e},{gas:"30 Tgas",attachedDeposit:BigInt("500000000000000000000000")}).send()];case 2:return[2,{accountId:e,hasStorage:!1,depositTxHash:r.sent().transaction.hash}]}})}).call(this)}},{key:"submitDelegateAction",value:function(e){return z(function(){var t;return A(this,function(r){switch(r.label){case 0:return t=(0,a.y7)(e),console.debug("[Relayer] signed delegate submitted to ".concat(this.relayerAccountId)),[4,this.near.transaction(this.relayerAccountId).signedDelegateAction(t).send()];case 1:return[2,{hash:r.sent().transaction.hash}]}})}).call(this)}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}(),T=[{slug:"men",name:"Men",description:"Men's apparel and accessories"},{slug:"women",name:"Women",description:"Women's apparel and accessories"},{slug:"accessories",name:"Accessories",description:"Bags, hats, and more"},{slug:"exclusives",name:"Exclusives",description:"Limited edition items"}],_=[{id:"1",category:"Men",name:"NEAR Protocol Hoodie",price:65,currency:"USD",image:"/images/product-1.png"},{id:"2",category:"Women",name:"Classic NEAR Tee",price:35,currency:"USD",image:"/images/product-2.png"},{id:"3",category:"Accessories",name:"NEAR Snapback Cap",price:28,currency:"USD",image:"/images/product-3.png"},{id:"4",category:"Accessories",name:"Protocol Tote Bag",price:22,currency:"USD",image:"/images/product-4.png"},{id:"5",category:"Accessories",name:"NEAR Coffee Mug",price:18,currency:"USD",image:"/images/product-5.png"},{id:"6",category:"Exclusives",name:"Sticker Pack",price:12,currency:"USD",image:"/images/product-6.png"},{id:"7",category:"Men",name:"Men's Essential Tee - Black",price:32,currency:"USD",image:"https://images.unsplash.com/photo-1667744565777-fa2eb22adeeb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=1080"},{id:"8",category:"Men",name:"Men's Oversized Tee",price:38,currency:"USD",image:"/images/product-8.png"},{id:"9",category:"Women",name:"Women's Crop Tee",price:30,currency:"USD",image:"/images/product-9.png"},{id:"10",category:"Men",name:"Men's Polo Shirt",price:45,currency:"USD",image:"/images/product-10.png"},{id:"11",category:"Women",name:"Women's Fitted Tee",price:30,currency:"USD",image:"/images/product-11.png"},{id:"12",category:"Exclusives",name:"Founder's Edition Tee",price:40,currency:"USD",image:"/images/product-12.png"},{id:"13",category:"Women",name:"Women's Crop Tee",price:30,currency:"USD",image:"/images/product-13.png"},{id:"14",category:"Men",name:"Men's Oversized Tee",price:38,currency:"USD",image:"/images/product-14.png"},{id:"15",category:"Exclusives",name:"Limited Edition Black Tee",price:45,currency:"USD",image:"/images/product-15.png"},{id:"16",category:"Women",name:"Women's Hoodie",price:68,currency:"USD",image:"/images/product-16.png"},{id:"17",category:"Accessories",name:"NEAR Backpack",price:75,currency:"USD",image:"/images/product-17.png"},{id:"18",category:"Accessories",name:"NEAR Water Bottle",price:20,currency:"USD",image:"/images/product-18.png"}];function j(e){return _.find(function(t){return t.id===e})}function D(e){return _.filter(function(t){return t.category===e})}function U(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}function x(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var R=function(){var e;function t(){if(!(this instanceof t))throw TypeError("Cannot call a class as a function")}return e=[{key:"getProducts",value:function(e){return o.Effect.sync(function(){var t=e.category,r=e.limit,n=e.offset,o=void 0===n?0:n,i=t?D(t):_,a=i.length;return{products:i=i.slice(o,o+(void 0===r?50:r)),total:a}})}},{key:"getProduct",value:function(e){return o.Effect.gen(function(){var t;return U(this,function(r){switch(r.label){case 0:if(t=j(e))return[3,2];return[5,x(o.Effect.fail(Error("Product not found: ".concat(e))))];case 1:return[2,r.sent()];case 2:return[2,{product:t}]}})})}},{key:"searchProducts",value:function(e){return o.Effect.sync(function(){var t,r=e.query,n=e.category,o=e.limit;return{products:(t=r.toLowerCase(),_.filter(function(e){var o=!r||e.name.toLowerCase().includes(t),i=!n||e.category===n;return o&&i})).slice(0,void 0===o?20:o)}})}},{key:"getFeaturedProducts",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return o.Effect.sync(function(){return{products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return _.slice(0,e)}(e)}})}},{key:"getCollections",value:function(){return o.Effect.sync(function(){return{collections:T}})}},{key:"getCollection",value:function(e){return o.Effect.gen(function(){var t,r,n;return U(this,function(i){switch(i.label){case 0:if(t=T.find(function(t){return t.slug===e}))return[3,2];return[5,x(o.Effect.fail(Error("Collection not found: ".concat(e))))];case 1:return[2,i.sent()];case 2:return n=(r=({men:"Men",women:"Women",accessories:"Accessories",exclusives:"Exclusives"})[e])?D(r):[],[2,{collection:t,products:n}]}})})}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();function W(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}function N(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var G=function(){var e;function t(){var e,r;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");e="orders",r=new Map,e in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}return e=[{key:"createOrder",value:function(e){var t=this;return o.Effect.sync(function(){var r=new Date().toISOString(),n={id:crypto.randomUUID(),userId:e.userId,productId:e.productId,productName:e.productName,quantity:e.quantity,totalAmount:e.totalAmount,currency:e.currency,status:"pending",fulfillmentReferenceId:"order_".concat(Date.now(),"_").concat(e.userId),createdAt:r,updatedAt:r};return t.orders.set(n.id,n),n})}},{key:"getOrder",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:case 3:return[2,n.sent()];case 2:if(!(t&&r.userId!==t))return[3,4];return[5,N(o.Effect.fail(Error("Unauthorized")))];case 4:return[2,{order:r}]}})})}},{key:"getOrders",value:function(e,t){var r=this;return o.Effect.sync(function(){var n=t.limit,o=t.offset,i=void 0===o?0:o,a=Array.from(r.orders.values()).filter(function(t){return t.userId===e}).sort(function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}),c=a.length;return{orders:a.slice(i,i+(void 0===n?10:n)),total:c}})}},{key:"updateOrderCheckout",value:function(e,t,r){return o.Effect.gen(this,function(){var n;return W(this,function(i){switch(i.label){case 0:if(n=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,i.sent()];case 2:return n.checkoutSessionId=t,n.checkoutProvider=r,n.updatedAt=new Date().toISOString(),[2,n]}})})}},{key:"updateOrderStatus",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,n.sent()];case 2:return r.status=t,r.updatedAt=new Date().toISOString(),[2,r]}})})}},{key:"updateOrderShipping",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,n.sent()];case 2:return r.shippingAddress=t,r.updatedAt=new Date().toISOString(),[2,r]}})})}},{key:"updateOrderFulfillment",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,n.sent()];case 2:return r.fulfillmentOrderId=t,r.status="processing",r.updatedAt=new Date().toISOString(),[2,r]}})})}},{key:"updateOrderTracking",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,n.sent()];case 2:return r.trackingInfo=t,r.updatedAt=new Date().toISOString(),[2,r]}})})}},{key:"updateOrderDeliveryEstimate",value:function(e,t){return o.Effect.gen(this,function(){var r;return W(this,function(n){switch(n.label){case 0:if(r=this.orders.get(e))return[3,2];return[5,N(o.Effect.fail(Error("Order not found")))];case 1:return[2,n.sent()];case 2:return r.deliveryEstimate=t,r.updatedAt=new Date().toISOString(),[2,r]}})})}},{key:"getOrderByFulfillmentReference",value:function(e){var t=this;return o.Effect.sync(function(){var r=!0,n=!1,o=void 0;try{for(var i,a=t.orders.values()[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var c=i.value;if(c.fulfillmentReferenceId===e)return c}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}})}},{key:"getOrderByCheckoutSession",value:function(e){var t=this;return o.Effect.sync(function(){var r=!0,n=!1,o=void 0;try{for(var i,a=t.orders.values()[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var c=i.value;if(c.checkoutSessionId===e)return c}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}})}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}(),F=r(7310);function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function q(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){r(e);return}c.done?t(u):Promise.resolve(u).then(n,o)}function B(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){q(i,n,o,a,c,"next",e)}function c(e){q(i,n,o,a,c,"throw",e)}a(void 0)})}}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function H(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var Y=function(){var e;function t(e,r){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");L(this,"stripe",void 0),L(this,"webhookSecret",void 0),this.stripe=new F.A(e,{apiVersion:"2025-11-17.clover"}),this.webhookSecret=r}return e=[{key:"createCheckoutSession",value:function(e){var t=this;return o.Effect.tryPromise({try:function(){return B(function(){var t;return H(this,function(r){switch(r.label){case 0:return[4,this.stripe.checkout.sessions.create({payment_method_types:["card"],shipping_address_collection:{allowed_countries:["US","CA","GB","AU","DE","FR","IT","ES","NL","SE","NO","FI","DK","BE","AT","CH","PT","IE","NZ","SG","JP"]},shipping_options:[{shipping_rate_data:{type:"fixed_amount",fixed_amount:{amount:0,currency:e.currency.toLowerCase()},display_name:"Free Shipping",delivery_estimate:{minimum:{unit:"business_day",value:5},maximum:{unit:"business_day",value:10}}}}],line_items:[{price_data:{currency:e.currency.toLowerCase(),product_data:{name:e.productName,description:e.productDescription,images:e.productImage?[e.productImage]:void 0},unit_amount:e.unitAmount},quantity:e.quantity}],mode:"payment",success_url:"".concat(e.successUrl,"?session_id={CHECKOUT_SESSION_ID}"),cancel_url:e.cancelUrl,customer_email:e.customerEmail,metadata:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){L(e,t,r[t])})}return e}({orderId:e.orderId},e.metadata)})];case 1:return[2,{sessionId:(t=r.sent()).id,url:t.url}]}})}).call(t)},catch:function(e){return Error("Stripe checkout failed: ".concat(K(e,Error)?e.message:String(e)))}})}},{key:"verifyWebhookSignature",value:function(e,t){var r=this;return o.Effect.tryPromise({try:function(){return B(function(){return H(this,function(r){switch(r.label){case 0:return[4,this.stripe.webhooks.constructEventAsync(e,t,this.webhookSecret)];case 1:return[2,r.sent()]}})}).call(r)},catch:function(e){return Error("Webhook verification failed: ".concat(K(e,Error)?e.message:String(e)))}})}},{key:"getCheckoutSession",value:function(e){var t=this;return o.Effect.tryPromise({try:function(){return B(function(){return H(this,function(t){switch(t.label){case 0:return[4,this.stripe.checkout.sessions.retrieve(e)];case 1:return[2,t.sent()]}})}).call(t)},catch:function(e){return Error("Failed to retrieve session: ".concat(K(e,Error)?e.message:String(e)))}})}},{key:"extractShippingAddress",value:function(e){var t,r,n,o,i,a,c,u,s,l=null==(r=e.collected_information)?void 0:r.shipping_details;if(!l)return null;var d=function(e){if(Array.isArray(e))return e}(t=(null==(n=l.name)?void 0:n.split(" "))||["",""])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return M(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M(e,void 0)}}(t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f=d[0],p=d.slice(1);try{return m.parse({firstName:f,lastName:p.join(" "),addressLine1:(null==(o=l.address)?void 0:o.line1)||"",addressLine2:(null==(i=l.address)?void 0:i.line2)||void 0,city:(null==(a=l.address)?void 0:a.city)||"",state:(null==(c=l.address)?void 0:c.state)||"",postCode:(null==(u=l.address)?void 0:u.postal_code)||"",country:(null==(s=l.address)?void 0:s.country)||"",email:"orders@demo.everything.market",phone:void 0})}catch(e){return null}}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();function J(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){r(e);return}c.done?t(u):Promise.resolve(u).then(n,o)}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var X={passed:"processing",completed:"processing",printing:"printing",shipped:"shipped",delivered:"delivered",cancelled:"cancelled",canceled:"cancelled"},Z=function(){var e;function t(e,r){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");V(this,"apiKey",void 0),V(this,"webhookSecret",void 0),V(this,"baseUrl","https://order.gelatoapis.com/v4"),this.apiKey=e,this.webhookSecret=r}return e=[{key:"createOrder",value:function(e){var t=this;return o.Effect.tryPromise({try:function(){var r;return(r=function(){var t;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,fetch("".concat(this.baseUrl,"/orders"),{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":this.apiKey},body:JSON.stringify(e)})];case 1:if((t=r.sent()).ok)return[3,3];return[4,t.text()];case 2:throw console.error("Gelato API error response:",r.sent()),Error("Gelato API error: ".concat(t.status," ").concat(t.statusText));case 3:return[4,t.json()];case 4:return[2,{id:r.sent().id}]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){J(i,n,o,a,c,"next",e)}function c(e){J(i,n,o,a,c,"throw",e)}a(void 0)})}).call(t)},catch:function(e){var t;return Error("Fulfillment order failed: ".concat((null!=(t=Error)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t)?e.message:String(e)))}})}},{key:"verifyWebhookSignature",value:function(e,t){var r=this;return o.Effect.sync(function(){return t===r.webhookSecret})}},{key:"getReturnAddress",value:function(){return{firstName:"Returns",lastName:"Department",companyName:"Demo Company",addressLine1:"456 Return Street",city:"Return City",state:"CA",postCode:"67890",country:"US",email:"returns@example.com",phone:"0987654321"}}},{key:"buildOrderData",value:function(e){return{orderReferenceId:e.fulfillmentReferenceId,customerReferenceId:e.userId,currency:e.currency,items:[{itemReferenceId:"item_".concat(e.orderId),productUid:e.productUid,files:[{type:"default",url:e.fileUrl}],quantity:e.quantity}],shipmentMethodUid:"express",shippingAddress:e.shippingAddress,returnAddress:this.getReturnAddress()}}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();function $(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){r(e);return}c.done?t(u):Promise.resolve(u).then(n,o)}function Q(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){$(i,n,o,a,c,"next",e)}function c(e){$(i,n,o,a,c,"throw",e)}a(void 0)})}}function ee(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){var s=[c,u];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}let et=(0,n.createPlugin)({variables:i.z.object({network:i.z.enum(["mainnet","testnet"]).default("mainnet"),contractId:i.z.string().default("social.near"),nodeUrl:i.z.string().optional()}),secrets:i.z.object({relayerAccountId:i.z.string().min(1,"Relayer account ID is required"),relayerPrivateKey:i.z.string().min(1,"Relayer private key is required"),STRIPE_SECRET_KEY:i.z.string().optional(),STRIPE_WEBHOOK_SECRET:i.z.string().optional(),GELATO_API_KEY:i.z.string().optional(),GELATO_WEBHOOK_SECRET:i.z.string().optional()}),contract:k,initialize:function(e){return o.Effect.gen(function(){var t,r,n,i,c,u,s;return ee(this,function(l){switch(l.label){case 0:return t=e.variables.nodeUrl?{networkId:e.variables.network,rpcUrl:e.variables.nodeUrl}:e.variables.network,console.log("[API Init] relayerAccountId: ".concat(e.secrets.relayerAccountId)),console.log("[API Init] network: ".concat(e.variables.network)),console.log("[API Init] contractId: ".concat(e.variables.contractId)),r=new a.jV,[5,function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(o.Effect.promise(function(){return r.add(e.secrets.relayerAccountId,(0,a.Do)(e.secrets.relayerPrivateKey))}))];case 1:return l.sent(),n=new C(new a.zU({network:t,keyStore:r,defaultSignerId:e.secrets.relayerAccountId,defaultWaitUntil:"FINAL"}),e.secrets.relayerAccountId,e.variables.contractId),i=new R,c=new G,u=e.secrets.STRIPE_SECRET_KEY&&e.secrets.STRIPE_WEBHOOK_SECRET?new Y(e.secrets.STRIPE_SECRET_KEY,e.secrets.STRIPE_WEBHOOK_SECRET):null,s=e.secrets.GELATO_API_KEY&&e.secrets.GELATO_WEBHOOK_SECRET?new Z(e.secrets.GELATO_API_KEY,e.secrets.GELATO_WEBHOOK_SECRET):null,console.debug("[API Init] Services initialized"),[2,{relayerService:n,productService:i,orderService:c,stripeService:u,fulfillmentService:s}]}})})},shutdown:function(){return o.Effect.void},createRouter:function(e,t){var r=e.relayerService,n=e.productService,i=e.orderService,a=e.stripeService,c=e.fulfillmentService;return{connect:t.connect.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,r.ensureStorageDeposit(t.accountId)];case 1:return[2,e.sent()]}})})()}),publish:t.publish.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,r.submitDelegateAction(t.payload)];case 1:return[2,e.sent()]}})})()}),ping:t.ping.handler(function(){return Q(function(){return ee(this,function(e){return[2,{status:"ok",timestamp:new Date().toISOString()}]})})()}),getProducts:t.getProducts.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.getProducts(t))];case 1:return[2,e.sent()]}})})()}),getProduct:t.getProduct.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.getProduct(t.id))];case 1:return[2,e.sent()]}})})()}),searchProducts:t.searchProducts.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.searchProducts(t))];case 1:return[2,e.sent()]}})})()}),getFeaturedProducts:t.getFeaturedProducts.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.getFeaturedProducts(t.limit))];case 1:return[2,e.sent()]}})})()}),getCollections:t.getCollections.handler(function(){return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.getCollections())];case 1:return[2,e.sent()]}})})()}),getCollection:t.getCollection.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(n.getCollection(t.slug))];case 1:return[2,e.sent()]}})})()}),createCheckout:t.createCheckout.handler(function(e){var t=e.input;return Q(function(){var e,r,n,c;return ee(this,function(u){switch(u.label){case 0:if(!a)throw Error("Stripe is not configured");if(!(e=j(t.productId)))throw Error("Product not found: ".concat(t.productId));return r=100*e.price*t.quantity,[4,o.Effect.runPromise(i.createOrder({userId:"demo-user",productId:e.id,productName:e.name,quantity:t.quantity,totalAmount:r,currency:e.currency||"USD"}))];case 1:return n=u.sent(),[4,o.Effect.runPromise(a.createCheckoutSession({orderId:n.id,productName:e.name,productDescription:e.description,productImage:e.image,unitAmount:100*e.price,currency:e.currency||"USD",quantity:t.quantity,successUrl:t.successUrl,cancelUrl:t.cancelUrl}))];case 2:return c=u.sent(),[4,o.Effect.runPromise(i.updateOrderCheckout(n.id,c.sessionId,"stripe"))];case 3:return u.sent(),[2,{checkoutSessionId:c.sessionId,checkoutUrl:c.url,orderId:n.id}]}})})()}),getOrders:t.getOrders.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(i.getOrders("demo-user",t))];case 1:return[2,e.sent()]}})})()}),getOrder:t.getOrder.handler(function(e){var t=e.input;return Q(function(){return ee(this,function(e){switch(e.label){case 0:return[4,o.Effect.runPromise(i.getOrder(t.id,"demo-user"))];case 1:return[2,e.sent()]}})})()}),stripeWebhook:t.stripeWebhook.handler(function(e){var t=e.input;return Q(function(){var e,r,n,u,s,l,d,f,p;return ee(this,function(h){switch(h.label){case 0:if(!a||!c)throw Error("Stripe or fulfillment service not configured");return[4,o.Effect.runPromise(a.verifyWebhookSignature(t.body,t.signature))];case 1:if("checkout.session.completed"!==(e=h.sent()).type||!(u=null==(r=(n=e.data.object).metadata)?void 0:r.orderId))return[3,13];return[4,o.Effect.runPromise(a.getCheckoutSession(n.id))];case 2:if(s=h.sent(),!(l=a.extractShippingAddress(s)))return[3,11];return[4,o.Effect.runPromise(i.updateOrderShipping(u,l))];case 3:return h.sent(),[4,o.Effect.runPromise(i.updateOrderStatus(u,"paid"))];case 4:return h.sent(),[4,o.Effect.runPromise(i.getOrder(u))];case 5:d=h.sent().order,f=c.buildOrderData({orderId:d.id,userId:d.userId,productUid:"apparel_product_gca_t-shirt_gsc_crewneck_gcu_unisex_gqa_classic_gsi_s_gco_white_gpr_4-4",fileUrl:"https://cdn-origin.gelato-api-dashboard.ie.live.gelato.tech/docs/sample-print-files/logo.png",quantity:d.quantity,currency:d.currency,shippingAddress:l,fulfillmentReferenceId:d.fulfillmentReferenceId}),h.label=6;case 6:return h.trys.push([6,9,,10]),[4,o.Effect.runPromise(c.createOrder(f))];case 7:return p=h.sent(),[4,o.Effect.runPromise(i.updateOrderFulfillment(u,p.id))];case 8:return h.sent(),[3,10];case 9:return console.error("Failed to create fulfillment order:",h.sent()),[3,10];case 10:return[3,13];case 11:return[4,o.Effect.runPromise(i.updateOrderStatus(u,"paid"))];case 12:h.sent(),h.label=13;case 13:return[2,{received:!0}]}})})()}),fulfillmentWebhook:t.fulfillmentWebhook.handler(function(e){var t=e.input;return Q(function(){var e,r,n,a,u,s,l,d,f,p,h,m,g,y,b,v,S,E,w;return ee(this,function(k){switch(k.label){case 0:if(!c)throw Error("Fulfillment service not configured");return[4,o.Effect.runPromise(c.verifyWebhookSignature(t.body,t.signature))];case 1:if(!k.sent())throw Error("Invalid webhook signature");switch((e=JSON.parse(t.body)).event){case"order_status_updated":return[3,2];case"order_item_tracking_code_updated":return[3,7];case"order_delivery_estimate_updated":return[3,12]}return[3,16];case 2:return r=e.orderReferenceId,n=e.fulfillmentStatus,a=e.items,[4,o.Effect.runPromise(i.getOrderByFulfillmentReference(r))];case 3:if(!(u=k.sent()))return[3,6];return s=X[n.toLowerCase()]||"processing",[4,o.Effect.runPromise(i.updateOrderStatus(u.id,s))];case 4:if(k.sent(),!((l=function(e){var t=[],r=!0,n=!1,o=void 0;try{for(var i,a=(e||[])[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var c=i.value,u=!0,s=!1,l=void 0;try{for(var d,f=(c.fulfillments||[])[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var p=d.value;t.push({trackingCode:p.trackingCode,trackingUrl:p.trackingUrl,shipmentMethodName:p.shipmentMethodName,shipmentMethodUid:p.shipmentMethodUid,fulfillmentCountry:p.fulfillmentCountry,fulfillmentStateProvince:p.fulfillmentStateProvince,fulfillmentFacilityId:p.fulfillmentFacilityId})}}catch(e){s=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return t}(a)).length>0))return[3,6];return[4,o.Effect.runPromise(i.updateOrderTracking(u.id,l))];case 5:k.sent(),k.label=6;case 6:return[3,16];case 7:return d=e.orderReferenceId,f=e.trackingCode,p=e.trackingUrl,h=e.shipmentMethodName,[4,o.Effect.runPromise(i.getOrderByFulfillmentReference(d))];case 8:if(!(m=k.sent()))return[3,11];return g=m.trackingInfo||[],y={trackingCode:f,trackingUrl:p,shipmentMethodName:h},(b=g.findIndex(function(e){return e.trackingCode===f}))>=0?g[b]=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},g[b],y):g.push(y),[4,o.Effect.runPromise(i.updateOrderTracking(m.id,g))];case 9:return k.sent(),[4,o.Effect.runPromise(i.updateOrderStatus(m.id,"shipped"))];case 10:k.sent(),k.label=11;case 11:return[3,16];case 12:return v=e.orderReferenceId,S=e.minDeliveryDate,E=e.maxDeliveryDate,[4,o.Effect.runPromise(i.getOrderByFulfillmentReference(v))];case 13:if(!(w=k.sent()))return[3,15];return[4,o.Effect.runPromise(i.updateOrderDeliveryEstimate(w.id,{minDeliveryDate:S,maxDeliveryDate:E}))];case 14:k.sent(),k.label=15;case 15:return[3,16];case 16:return[2,{received:!0}]}})})()})}}})}};
//# sourceMappingURL=__federation_expose_plugin.js.map